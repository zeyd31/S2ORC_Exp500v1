
WHEN IS TIGHT CLOSURE DETERMINED BY THE TEST IDEAL?
10 Sep 2008

Janet C Vassilev 
Adela N Vraciu 
WHEN IS TIGHT CLOSURE DETERMINED BY THE TEST IDEAL?
10 Sep 2008arXiv:0809.1891v1 [math.AC]
We characterize the rings in which the equality (τ I : τ ) = I * holds for every ideal I ⊂ R. Under certain assumptions, these rings must be either weakly F-regular or one-dimensional.

Introduction

Test ideals play a major role in the theory of tight closure. The tight closure of arbitrary ideals is very difficult to compute, even in relatively simple rings, but the test ideal can be frequently computed, especially in Gorenstein rings. Moreover, test ideals encode geometric information about the nature of the singularity of the ring. We recall the definitions and basic facts.

Throughout this paper, (R, m) is a local domain of characteristic p. We denote positive integer powers of p by q.

Definition 1.1. Let I ⊂ R be an ideal. We say that x ∈ R is in the tight closure, I * , of I if there is a c = 0 such that cx q ∈ I [q] = ({i q |i ∈ I}). We say that I is tightly closed if I = I * .

Definition 1.2. The test ideal τ is defined by τ = I⊂R (I : I * ),

where I runs over all ideals I ⊂ R.

The fact that τ = (0) is a highly nontrivial and important result. It is clear from the definition that I * ⊆ I : τ , and thus I : τ provides an upper bound for tight closure. This bound can be somewhat refined with additional assumptions on the ring, as shown in the following result of the second author: Theorem 1.3. [Vr1] If R is a complete domain of characteristic p, then the test ideal is a strong test ideal, i.e. we have τ I = τ I * , and thus I * ⊆ (τ I : τ ) for all ideals I ⊂ R.

Also in the case when the test ideal is the maximal ideal, a theorem of Hara and Smith [HS] says that over any local ring with test ideal equal to the maximal ideal, the test ideal is the strong test ideal.

We say that tight closure is determined by the test ideal if the equality I * = τ I : τ holds. This is known to hold if the ideal I is generated by a system of parameters in a Gorenstein ring R (Corollary 4.2 (2) in [Hu1]), or, more generally, if I is an ideal of finite projective dimension in a Gorenstein ring (Theorem 1(a) in [Vr2]). The main result of this paper shows, under certain assumptions, that the equality cannot hold for all ideals I ⊂ R unless the ring is weakly F-regular (i.e. τ = R) or one-dimensional.

In a similar vein, we mention a result of Yao [Thm. 2.5 (ii)] in [Ya], which states that if R has finite Frobenius representation type, then there exists a finitely generated R-module N such that I * = (IN : R N) for every ideal I ⊂ R. Thus, our result indicates that the R-module N cannot be an ideal unless R is one-dimensional or weakly F-regular.

A different motivation for our work comes from the following result of Heinzer, Ratliff and Rush in [HRR][Theorem 7.5]:

Theorem 1.4. Let (R, m) be a local ring. A necessary and sufficient condition for every nonzero m-primary ideal of R to be basically full is that m is principal and that R is a principal ideal ring.

In their terminology, an m-primary ideal I is basically full if (mI : m) = I, and for any ideal I, (mI : m) is called the basically full closure of I. The original motivation for this paper was the desire to extend Theorem 1.4 to take tight closure into account. Thus, we asked the question: when is (mI : m) = I * for all m-primary ideals I ⊂ R? Theorem 3.2 shows that (under certain assumptions) this is the case if and only if R is one-dimensional.


* -T -basically full ideals

We extend the definition of the basically full closure in [HRR] using any ideal T to define the T -basically full closure of an ideal I to be I T bf = (T I : T ). This is a true closure operation as: We want to determine the domains which satisfy I T bf = I * for all m-primary ideals I. This prompts the following definition:

Definition 2.2. I is T -basically full if I T bf = I. We will say that I is * -T -basically full if I T bf = I * .

Theorem 2.3. Let (R, m) be a complete local normal Cohen Macaulay domain of positive characteristic with perfect residue field having a canonical module and let τ be the test ideal. If T is an ideal of grade at least two, then every m-primary ideal is * -T -basically full if and only if R is weakly F -regular and T = R. In particular, every m-primary ideal is * -τ -basically full if and only if R is weakly F-regular.

Before the proof, note that the normal assumption is necessary. If R is a onedimensional domain (in which case normal is equivalent to regular and therefore it is also equivalent to weakly F-regular) the following Proposition shows that every m-primary ideal is * -τ -basically full.

Proposition 2.4. Assume that (R, m) is complete domain with infinite residue field. If R has Krull dimension one, then every m-primary ideal is * -τ -basically full.

Proof: In a one-dimensional domain with infinite residue field, every m-primary ideal I has a principal minimal reduction (x). For principal ideals, tight closure is the same as integral closure, and it follows that I * = (x) * (see [Hu2][Example 1.6.2]).

We have
(τ I : τ ) ⊆ (τ I * : τ ) = (τ (x) * : τ ) = (τ (x) : τ ) ⊆ (x) = (x) * = I * .
The equality τ (x) * : τ = τ (x) : τ uses the fact that τ is a strong test ideal, and the inclusion τ (x) : τ ⊆ (x) uses the determinant trick. Since τ is a strong test ideal, the inclusion I * ⊆ (τ I : τ ) also holds.

Note that in the case of a one-dimensional domain, the only non m-primary ideals are (0) and R, and thus Theorem 2.3 shows that in this case I * = τ I : τ holds for every ideal I, hence the tight closure of every ideal in a one-dimensional domain is determined by the test ideal.

Proof of 2.3: Note that the last statement follows from the previous one, since in an excellent normal ring the test ideal always has depth at least two (see Theorem 6.2 in [HH2]).

One implication is clear: if R is weakly F -regular and T = R, then I * = I = T I : T for every ideal I ⊂ R.

Conversely, suppose that all m-primary ideals are * -T -basically full. It is enough to prove that T must be a principal ideal, because then the grade assumption implies that T = R, and thus I * = T I : T = I for every m-primary ideal I, which implies that R is weakly F-regular.

Assume by contradiction that the minimal number of generators of T is ν(T ) = n ≥ 2, and write T = (y 1 , y 2 , . . . , y n ).

Following the argument (2.2.1), the proof of Theorem 2.2.2 in [Ab2], suppose J is a canonical ideal and choose x 1 , . . . , x d a system of parameters for R such that x 1 ∈ J, and x 2 , . . . , x d form a regular sequence modulo J. Note that a = (J,
x 2 , . . . x d ) is an irreducible ideal, and a t = (x t−1 1 J, x t 2 , . . . x t d ) are irreducible for all t ≥ 2. Let v denote the socle element of a, i.e. (a : m) = (a, v) and let v t = (x 1 · · · x d ) t−1 v be the socle element of a t .
By Matlis duality, we have
λ (a t : mT ) (a t : T ) = λ a t + T a t + mT = λ T a t ∩ T + mT .
Note that a t ∩ T ⊆ m t ∩ T ⊆ mT for t ≫ 0 by the Artin-Rees Lemma, and therefore this length is equal to one if and only if T is a principal ideal. Fix a t 0 large enough so that
λ (a t 0 : mT ) (a t 0 : T ) ≥ 2
and choose u 1 , u 2 ∈ (a t 0 : mT ) such that their images are linearly independent in the vector space (a t 0 : mT )/(a t 0 : T ).

Note that for all t ≥ 1, (x 1 · · · x d ) t u 1 , (x 1 · · · x d ) t u 2 ∈ (a t 0 +t : mT ), and their images in (a t 0 +t : mT )/(a t 0 +t : T ) are linearly independent, because the map R/a t 0 → R/a t 0 +t given by multiplication by (x 1 · · · x d ) t is injective.

Consider the ideals
I t1 = (a t 0 +t , (x 1 · · · x d ) t u 2 ), I t2 = (a t 0 +t , (x 1 · · · x d ) t u 1 ).
We claim that (x 1 · · · x d ) t u i ∈ T I ti : T for i = 1, 2 when t ≫ 0.

The key point in the proof of the claim is the observation that the assumption that T has grade at least two implies that we can choose x 1 , . . . , x d so that at least two of them belong to T (by prime avoidance). With the x's chosen this way, we have
(2.1) (x 1 . . . x d ) t a t 0 ⊆ T a t 0 +t .
For j = 1, . . . , n, we have u i y j ∈ a t 0 : m = (a t 0 , v t 0 ). Moreover, since u i / ∈ a t 0 : T , for each i there exists a j = j i such that u i y j i / ∈ a t 0 , so that we can write u i y j i = αv t 0 (mod a t 0 ), where α is a unit. This shows that v t 0 ∈ (a t 0 , T u i ) for all i, and therefore
(x 1 · · · x d ) t v t 0 ∈ ((x 1 . . . x d ) t a t 0 , T (x 1 . . . x d ) t u i ) ⊆ T (a t 0 +t , (x 1 . . . x d ) t u i )
when t ≫ 0 by Equation 2.1. Combining Equation 2.1 with the above chain of containments, we conclude that (x 1 · · · x d ) t (a t 0 , v t 0 ) ⊆ T I ti for each i (when t ≫ 0), which finishes the proof of the claim, since (
x 1 · · · x d ) t u i T ⊆ (x 1 · · · x d ) t (a t 0 , v t 0 ) by the choice of u 1 , u 2 .
Since the ideals I ti are assumed to be * − T −basically full, we have (x 1 · · · x d ) t u i ∈ (T I ti : T ) = I * ti . Note that the same argument works when u 1 is replaced by u 1 + αu 2 , where α ∈ R is arbitrary. Therefore, Lemma 2.5 can be applied to see that (x 1 · · · x d ) t u i ∈ a * t 0 +t . This is a contradiction, since (x 1 · · · x d ) t u i / ∈ a t 0 +t : T and T a t 0 +t : T a t 0 +t : T which implies that (x 1 · · · x d ) t u i / ∈ a * t 0 +t = T a t 0 +t : T . Lemma 2.5. Assume that R is a complete normal domain of positive characteristic p, with perfect residue field. If I ⊂ R is an ideal, and f, g ∈ R are such that f ∈ (I, g) * and g ∈ (I, f + αg) * for all α ∈ R, then f, g ∈ I * .

Proof: Theorem 2.1 in [HV] shows that (I, g) * = (I, g) + (I, g) * sp , and therefore there exists an α ∈ R, a q 0 = p e 0 , and a c ∈ R o such that c(f + αg) q = bg q modI [q] for all q = p e , with b ∈ m q/q 0 . On the other hand, there exists c ′ ∈ R o such that c ′ g q = d(f + αg) q modI [q] . Combining these two equations, we get cc ′ (f + αg) q = bd(f + αg) q modI [q] . Since bd ∈ m q/q 0 and c, c ′ are fixed, Proposition 2.4 in [Ab1] shows that f +αg ∈ I * . Since g ∈ (I, f +αg) * , we also get g ∈ I * , and since f ∈ (I, g) * we now get f ∈ I * as well.

We cannot remove the assumption of perfect residue field in Lemma 2.5. Consider the following example motivated by [Ep] [Ep]. Let I = (x 2 , y 2 , z). x ∈ (I, y) F ⊆ (I, y) * and for all a ∈ R, y ∈ (I, x + ay) F ⊆ (I, x + ay) * . However, x, y / ∈ I * = (xy, x 2 , y 2 , z). Hence Lemma 2.5 requires a perfect residue field.

It may be however that Theorem 2.3 holds when the residue field is not perfect, as the above ring does not satisfy I * = (τ I : τ ) for all I. To see this we will compute the test ideal for R and exhibit the offending m-primary ideal I.

We claim that for all t ≥ p we have (y t , z t ) * = (y t , z t ) + m 2t−1 = (y t , z t ) : m p−1 , and thus τ = m p−1 .

In order to prove the first equality, it is enough to consider monomials of the form x k y r z s , with k ≤ p − 1. Note that x k y r z s ∈ (y t , z t ) ⇔ x k ∈ (y t−r , z t−s ) * ⇔ x kp ∈ (y (t−r)p , z (t−s)p ).

We have
x kp = (− 1 u (vy p + wz p )) k = (−1) k u k k i=0 k i v i w k−i y ip z (k−i)p ,
and thus the tight closure membership can be tested inside the regular ring k [[y, z]].

Since k ≤ p − 1, none of the binomial coefficients k i is equal to zero, and thus we see that x k ∈ (y t−s , z t−s ) * ⇔ for all i = 0, . . . , k we have either i ≥ t − r, or k − i ≥ t − s. This amounts to k ≥ 2t − r − s − 1, which proves the first equality. For the second equality, it is enough to show that (y t , z t ) : m 2t−1 = (y t , z t ) + m p−1 (since the ring is Gorenstein). It is easy to see that (y t , z t ) : m = (x t , y t , y t−1 z t−1 x p−1 ) = (y t , z t ) + m 2t+p−3 , and one can check by induction on l that (y t , z t ) : m l = (y t , z t ) + m 2t+p−2−l for all l ≥ 1. Taking l = 2t − 1 yields the desired conclusion. Now we show that for p ≥ 5, these rings do not have the property that every m-primary ideal is * -τ -basically full.

Consider I = (x 3 , y 3 , z 3 ) and r = xy 2 . We have r ∈ (m p−1 I : m p−1 ); however, r / ∈ I * . Using the relation, z p = − u w x p − v w y p , we see that
z 3p = − u 3 w 3 x 3p − 3 u 2 v w 3 x 2p y p − 3 uv 2 w 3 x p y 2p − v 3 w 3 y 3p .
Hence if xy 2 ∈ I * , then x p y 2p ∈ (x 3p , y 3p , z 3p ) * = (x 3p , y 3p , u 2 vx 2p y p + uv 2 x p y 2p ) * , implying that x p y 2p ∈ (x 3p , y 3p , x 2p y p ) * in the regular ring k [[x, y]]. This leads to a contradiction. For p = 3, consider the ideal I = (x 4 , y 4 , z 4 ) and r = xy 3 . Note that r ∈ (m 2 I : m 2 ) if and only if x 3 y 3 ∈ I which is the case as x 3 y 3 = u v x 6 + v u y 6 + 2 w 2 uv z 6 ∈ (x 4 , y 4 , z 4 ). As in the argument above, xy 3 ∈ I * is equivalent to xy 3 ∈ (x 4 , y 4 , x 3 y) * in the regular ring k [[x, y]]. Again this leads to a contradiction.

For p = 2, we have not found an ideal I for which (mI : m) = I * . For characteristic 3 and higher, the ring k[[x, y, z]]/(x 2 + y 2 + z 2 ) is F -rational. Certainly, Z/2Z (u, v, w) [[x, y, z]] (ux 2 + vy 2 + wz 2 ) is not as (y, z) * = m, but it may be that this ring satisfies (mI : m) = I * for all m-primary ideals I. Since we do not know whether the conclusion of Theorem 2.3 holds in the absence of the perfect residue field assumption, it is worth pointing out that if R is a Gorenstein ring and T is an ideal of grade at least two such that for every m-primary ideal I we have I * = T I : T , then T is forced to be the test ideal. In particular, this shows that the full conclusion of Theorem 2.3 holds for the rings considered in Example 2.6 for p ≥ 3.

Before the following proposition, we recall a definition of Hochster in his paper on Cyclic Purity [Ho] Hochster noted in [Ho][Remark 4.8(b)] that a generically Gorenstein Cohen Macaulay ring with a canonical module is approximately Gorenstein.

Proposition 2.8. Assume that (R, m) is an approximately Gorenstein ring with test ideal τ . If T is an ideal such that every m-primary ideal of R is * -T -basically full, then T ⊆ τ .

If we moreover assume that R is Gorenstein and T has grade at least two, then T = τ .

Note that the assumption that T has grade at least two is necessary in the second part of the Proposition. If R is a weakly F-regular domain and T is a principal ideal, then I * = I = T I : T for every I, but T = τ = R.

Proof: Let {a t } be a sequence of irreducible ideals cofinal with the powers of m. We have
τ = t a t : a * t = t a t : (T a t : T ) ⊇ t a t : (a t : T ) = t (a t + T ) = T.
Now assume that R is Gorenstein and T has grade at least two. Let x 1 , . . . , x d be a system of parameters for R such that at least two of them belong to T .

Let a t = (x t 1 , x t 2 , . . . , x t d ). We claim that a * t = a t : T for all t. Assuming the claim, we obtain
T = t (a t + T ) = t (a t : (a t : T )) = t (a t : a * t ) = τ.
In order to prove the claim, consider u ∈ a t : T . Since at least two out of x 1 , . . . , x d belong to T , we have (x 1 · · · x d )a t ⊆ T a t+1 , and therefore (x 1 · · · x d )u ∈ T a t+1 : T = a * t+1 . Thus, u ∈ a * t+1 : (x 1 · · · x d ) ⊆ a * t .

3. When the basically full closure and the tight closure correspond for all m-primary ideals

In this section we extend the definition of basically full closure of [HRR] in a slightly different direction, using the maximal ideal m instead of τ (thus, this version is closer to the original one in [HRR]).

Definition 3.1. We will say an m-primary ideal I is * -basically full if (mI : m) = I * .

Theorem 3.2. Let (R, m) be a local Cohen Macaulay domain.

(a). If R is a one-dimensional ring with test ideal equal to m, then all m primary ideals are * -basically full. (b). Assume in addition that R is normal and has perfect residue field. Then R is a one-dimensional ring if and only if all m primary ideals are * -basically full.

Proof: (a). Follows from the same proof as in Proposition 2.4 (using the fact that when m is the test ideal, it is a strong test ideal even without assuming that the ring is complete). If τ = m, then we are under the assumptions of Theorem 2.4, and thus τ = R, which is a contradiction. If τ = R, then we have (mI : m) = I * = I, i.e. every m-primary ideal is basically full, and Theorem 1.4 applies to show that R must have dimension one.

To see some examples we will use the following theorem from the first author's thesis [Va]:

Theorem 3.3. Let (R, m) be a one-dimensional domain. The test ideal of R is equal to the conductor, i.e. τ = c = {c ∈ R|φ(1) = c, φ ∈ Hom R (R, R)}.

Note, in a one-dimensional local semigroup ring, the semigroup is a sub-semigroup of N 0 . For each sub-semigroup S of N 0 , there is a smallest m such that for all i ≥ m, i ∈ S. The conductor of such a one dimensional semigroup ring is c =< t m , t m+1 , t m+2 , . . . >, [Ei][Exercise 21.11].

Example 3.4. The rings k[[t 2 , t 3 ]] and k[[t 3 , t 4 , t 5 ]] are one dimensional domains with test ideal equal to the maximal ideal. Every m-primary ideal of each ring is * -basically full.

Example 3.5. The test ideal of k[[t 2 , t 5 ]] is (t 4 , t 5 ) , hence there are ideals in k[[t 2 , t 5 ]] which are not * -basically full. For example, (t 4 ) * = (t 4 ) : (t 4 , t 5 ) = (t 4 , t 5 ) and (m(t 4 ) : m) = (t 4 , t 7 ) ⊆ (t 4 , t 5 ). In fact, for all n ≥ 4, (t n ) * = (t n , t n+1 ) (t n , t n+3 ) = (m(t n ) : m).

Proposition 2. 1 .
1Let (R, m) be a local domain. The T -basically full closure of an ideal (T I : T ) is a closure operation satisfying:(1) I ⊆ I T bf . (2) If I ⊆ J, then I T bf ⊆ J T bf . (3) (I T bf ) T bf = I T bf . (4) I T bf J T bf ⊆ (IJ) T bf .Proof: (1) and(2)are clear. For (3) note that if I is any ideal and I T bf = (T I : T ), T I T bf = T (T I : T ) = T I, hence (T I T bf : T ) = (T I : T ) = I T bf . For (4), note that I T bf J T bf = (T I : T )(T J : T ) ⊆ (T (T I : T )(T J : T ) : T ) ⊆ (T I(T J : T ) : T ) ⊆ (T IJ : T ) = (IJ) T bf .


(b). Assume that all m primary ideals are * -basically full. Note that this assumption implies that τ = m or τ = R,


[p. 381]:Example 2.6. Let R = 
Z/pZ(u, v, w)[[x, y, z]] 
(ux p + vy p + wz p ) 
which is a 2-dimensional, Gorenstein 

normal domain as remarked by Epstein in 


[Definition 1.1]: Definition 2.7. A local Noetherian ring (R, m) is approximately Gorenstein if for every N > 0, there is an m-primary ideal I ⊆ m N which is irreducible.

Extensions of weakly and strongly F-regular rings by flat maps. I Aberbach, J. Algebra. 5Aberbach, I., Extensions of weakly and strongly F-regular rings by flat maps, J. Algebra, 241 (2001), 799-807. 5

Some conditions for the equivalence of weak and strong F -regularity. I Aberbach, Comm. Algebra. 304Aberbach, I., Some conditions for the equivalence of weak and strong F -regularity, Comm. Algebra, 30 (2002), no. 4, 1635-1651. 4

Commutative Algebra with a View Toward Algebraic Geometry. D Eisenbud, Graduate Texts in Mathematics. 1508Springer-VerlagEisenbud, D., Commutative Algebra with a View Toward Algebraic Geometry, Graduate Texts in Mathematics, 150, Springer-Verlag, New York, 1995. 8

A tight closure analogue of analytic spread. N Epstein, Math. Proc. Camb. Phil. Soc. 1395Epstein, N., A tight closure analogue of analytic spread, Math. Proc. Camb. Phil. Soc., 139, (2005), 371-383. 5

The Strong Test Ideal. N Hara, K E Smith, Ill. J. Math. 453Hara, N., Smith, K.E., The Strong Test Ideal, Ill. J. Math., 45 N. 3, (2001), 949-964. 2

Basically Full Ideals in Local Rings. W Heinzer, L Ratliff, D Rush, J. of Alg. 2507Heinzer, W., Ratliff, L., Rush, D., Basically Full Ideals in Local Rings, J. of Alg. 250 (2002), 271-396. 2, 7

Cyclic Purity Versus Purity in Excellent Noetherian Rings. M Hochster, Trans. of the A. M. S. 2312Hochster, M., Cyclic Purity Versus Purity in Excellent Noetherian Rings, Trans. of the A. M. S., 231, No. 2. (1977), 463-488. 6

Tight closure, invariant theory, and the Brian?on-Skoda theorem. M Hochster, C Huneke, J. Amer. Math. Soc. 31Hochster, M., Huneke, C., Tight closure, invariant theory, and the Brian?on-Skoda theo- rem, J. Amer. Math. Soc. 3 (1990), no. 1, 31-116.

F-regularity, test elements, and smooth base change. M Hochster, C Huneke, Trans. Amer. Math. Soc. 3463Hochster, M., Huneke, C., F-regularity, test elements, and smooth base change, Trans. Amer. Math. Soc., 346 (1994), 1-62. 3

J Hong, H Lee, S Noh, D Rush, Full Ideals. preprintHong, J., Lee, H., Noh, S., Rush, D., Full Ideals, preprint.

Tight closure, parameter ideals, and geometry, Six lectures on commutative algebra. C Huneke, Progr. Math. 1662Huneke, C., Tight closure, parameter ideals, and geometry, Six lectures on commutative algebra (Bellaterra 1996), 187-239, Progr. Math., 166, Birkhuser, Basel, 1998. 2

Tight Closure and Its Applications. C Huneke, CBMS Lect. Notes Math. 883American Math. SocHuneke, C., Tight Closure and Its Applications, CBMS Lect. Notes Math. 88, American Math. Soc., Providence 1996. 3

Special tight closure. C Huneke, A Vraciu, Nagoya Math. J. 1705Huneke, C., Vraciu, A., Special tight closure, Nagoya Math. J., 170 (2003), 175-183. 5

Test ideals in F -finite reduced rings and Gorenstein isolated singularities, Thesis. J Vassilev, Los AngelesUniversity of CaliforniaVassilev, J., Test ideals in F -finite reduced rings and Gorenstein isolated singularities, Thesis, University of California, Los Angeles, 1997. 8

Strong test ideals. A Vraciu, J. Pure and Appl. Alg. 1671Vraciu, A., Strong test ideals, J. Pure and Appl. Alg., 167, (2002), 361-373. 1

Tight closure and linkage classes in Gorenstein rings. A Vraciu, Math. Z. 2442Vraciu, A., Tight closure and linkage classes in Gorenstein rings, Math. Z., 244(2003), 873-885. 2

Modules with finite F -representation type. Y Yao, J. London Math. Soc. 721Yao, Y., Modules with finite F -representation type, J. London Math. Soc. 72 (2005), no. 1, 53-72. 2
